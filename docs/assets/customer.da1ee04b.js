import"./modulepreload-polyfill.b7f2da20.js";/* empty css              */import{c as L,C as c}from"./index.77536023.js";const y=""+new URL("icon_sent.575f91f5.svg",import.meta.url).href,_=""+new URL("icon_wait.05ce8f12.svg",import.meta.url).href,S="https://neworder.deno.dev/",E="https://help.shopify.com/en/manual/orders/notifications/webhooks#create-webhooks",i=L(c.urlSupabase,c.anonBearer);var d,l;const r=(l=(d=i.auth.user())==null?void 0:d.id)!=null?l:"";(!r||r==="")&&(window.location.href="/");var u;(u=document.querySelector("#menuReviewed"))==null||u.addEventListener("click",k);var m;(m=document.querySelector("#menuOrders"))==null||m.addEventListener("click",q);var g;(g=document.querySelector("#user-menu-logout"))==null||g.addEventListener("click",b);var f;(f=document.querySelector("#menuCredentials"))==null||f.addEventListener("click",O);function k(){I(r)}function q(){w(r)}function O(){var e,n;const t=(e=document.querySelector("#list-content"))!=null?e:null;t&&(t.innerHTML=`
    <div>
      <div>
        <div class="row">
          <p>You need to setup a &nbsp;<a href="${E}"><strong>shopify webhook</strong></a>&nbsp;
          with the following URL: &nbsp;<strong>${S+r}</strong></p>
        </div>
        <div class="row">
          <p>Set &nbsp;<strong>Order payment</strong>&nbsp; as Event, &nbsp;<strong>JSON</strong>&nbsp;
          as Format and the API version with tag &nbsp;<strong>Latest</strong>.</p>
        </div>
      </div>
      <div>
        <div id='menuLogout' class='button'>Logout</div>
      </div>
    </div>
    `,(n=document.querySelector("#menuLogout"))==null||n.addEventListener("click",b))}function b(){i.auth.signOut().then(t=>t.error?console.log(t.error):window.location.href="/")}function h(t){var n;const e=(n=document.querySelector("#table-content"))!=null?n:null;e&&(e.innerHTML=t)}function x(t){let e="",n={year:"numeric",month:"long",day:"numeric"};t.forEach(o=>{var s;let a=new Date(o.created_at);e+="<tr>",e+='  <td class="border-b border-slate-100  p-4 pl-8 text-slate-500 ">',e+=a.toLocaleDateString("en-US",n),e+="  </td>",e+='  <td class="border-b border-slate-100  p-4 text-slate-500 ">',e+=(s=o.name)!=null?s:"- no name -",e+="  </td>",e+='  <td class="border-b border-slate-100  p-4 text-slate-500 ">',e+=o.title,e+="  </td>",e+='  <td class="border-b border-slate-100  p-4 pr-8 text-slate-500 ">',e+=o.score/20,e+="  </td>",e+="</tr>"}),h(e)}function U(t){let e="",n={year:"numeric",month:"long",day:"numeric"};t.forEach(o=>{let a=o.sent?y:_,s=o.sent?"black-to-green-filter":"black-to-yellow-filter",v=new Date(o.created_at);e+="<tr>",e+='  <td class="border-b border-slate-100  p-4 pl-8 text-slate-500 ">',e+=v.toLocaleDateString("en-US",n),e+="  </td>",e+='  <td class="border-b border-slate-100  p-4 text-slate-500 ">',e+=o.email,e+="  </td>",e+='  <td class="border-b border-slate-100  p-4 pr-8 text-slate-500 ">',e+=`    <img src='${a}' class='${s}' width=40px height=40px>`,e+="  </td>",e+="</tr>"}),h(e)}async function I(t){if(t==="")return;const{data:e,error:n}=await i.from("reviews").select().eq("user_id",r).order("created_at",{ascending:!1}).limit(10);n?console.log(n.message):x(e)}async function w(t,e){if(t==="")return;const{data:n,error:o}=await i.from("orders").select().eq("user_id",r).order("created_at",{ascending:!1}).limit(15);o?console.log(o.message):U(n)}function R(){var t;(t=document.querySelector("#user-menu"))==null||t.classList.toggle("hidden")}function D(){var t;(t=document.querySelector("#user-menu"))==null||t.classList.add("hidden")}window.addEventListener("click",function(t){var e;(e=document.getElementById("user-menu-button"))!=null&&e.contains(t.target)||D()});var p;(p=document.querySelector("#user-menu-button"))==null||p.addEventListener("click",R);w(r);
