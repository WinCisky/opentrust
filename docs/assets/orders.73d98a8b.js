import"./modulepreload-polyfill.b7f2da20.js";/* empty css              */import{c as S,C as a}from"./index.77536023.js";import{i as _,a as E}from"./icon_wait.ae8f9c92.js";const q="https://neworder.deno.dev/",k="https://help.shopify.com/en/manual/orders/notifications/webhooks#create-webhooks",i=S(a.urlSupabase,a.anonBearer);var l,u;const r=(u=(l=i.auth.user())==null?void 0:l.id)!=null?u:"";(!r||r==="")&&(window.location.href="/");var m;(m=document.querySelector("#menuReviewed"))==null||m.addEventListener("click",O);var g;(g=document.querySelector("#menuOrders"))==null||g.addEventListener("click",x);var b;(b=document.querySelector("#user-menu-logout"))==null||b.addEventListener("click",c);var p;(p=document.querySelector("#user-menu-mobile-logout"))==null||p.addEventListener("click",c);var f;(f=document.querySelector("#menuCredentials"))==null||f.addEventListener("click",I);function O(){D(r)}function x(){y(r)}function I(){var e,n;const t=(e=document.querySelector("#list-content"))!=null?e:null;t&&(t.innerHTML=`
    <div>
      <div>
        <div class="row">
          <p>You need to setup a &nbsp;<a href="${k}"><strong>shopify webhook</strong></a>&nbsp;
          with the following URL: &nbsp;<strong>${q+r}</strong></p>
        </div>
        <div class="row">
          <p>Set &nbsp;<strong>Order payment</strong>&nbsp; as Event, &nbsp;<strong>JSON</strong>&nbsp;
          as Format and the API version with tag &nbsp;<strong>Latest</strong>.</p>
        </div>
      </div>
      <div>
        <div id='menuLogout' class='button'>Logout</div>
      </div>
    </div>
    `,(n=document.querySelector("#menuLogout"))==null||n.addEventListener("click",c))}function c(){i.auth.signOut().then(t=>t.error?console.log(t.error):window.location.href="/")}function w(t){var n;const e=(n=document.querySelector("#table-content"))!=null?n:null;e&&(e.innerHTML=t)}function M(t){let e="",n={year:"numeric",month:"long",day:"numeric"};t.forEach(o=>{var s;let d=new Date(o.created_at);e+='<tr class="odd:bg-white even:bg-slate-50">',e+='  <td class="border-b border-slate-100  p-4 pl-8 text-slate-500 ">',e+=d.toLocaleDateString("en-US",n),e+="  </td>",e+='  <td class="border-b border-slate-100  p-4 text-slate-500 ">',e+=(s=o.name)!=null?s:"- no name -",e+="  </td>",e+='  <td class="border-b border-slate-100  p-4 text-slate-500 ">',e+=o.title,e+="  </td>",e+='  <td class="border-b border-slate-100  p-4 pr-8 text-slate-500 ">',e+=o.score/20,e+="  </td>",e+="</tr>"}),w(e)}function U(t){let e="",n={year:"numeric",month:"long",day:"numeric"};t.forEach(o=>{let d=o.sent?_:E,s=o.sent?"stroke-white":"fill-yellow",L=new Date(o.created_at);e+="<tr>",e+='  <td class="border-b border-slate-100  p-4 pl-8 text-slate-500 ">',e+=L.toLocaleDateString("en-US",n),e+="  </td>",e+='  <td class="border-b border-slate-100  p-4 text-slate-500 ">',e+=o.email,e+="  </td>",e+='  <td class="border-b border-slate-100  p-4 pr-8 text-slate-500 ">',e+=`    <img src='${d}' class='${s}' width=40px height=40px>`,e+="  </td>",e+="</tr>"}),w(e)}async function D(t){if(t==="")return;const{data:e,error:n}=await i.from("reviews").select().eq("user_id",r).order("created_at",{ascending:!1}).limit(10);n?console.log(n.message):M(e)}async function y(t,e){if(t==="")return;const{data:n,error:o}=await i.from("orders").select().eq("user_id",r).order("created_at",{ascending:!1}).limit(15);o?console.log(o.message):U(n)}function R(){var t;(t=document.querySelector("#user-menu"))==null||t.classList.toggle("hidden")}function C(){var t;(t=document.querySelector("#user-menu"))==null||t.classList.add("hidden")}function B(){var t;(t=document.querySelector("#mobile-menu"))==null||t.classList.toggle("hidden")}function H(){var t;(t=document.querySelector("#mobile-menu"))==null||t.classList.add("hidden")}window.addEventListener("click",function(t){var e,n;(e=document.getElementById("user-menu-button"))!=null&&e.contains(t.target)||C(),(n=document.getElementById("mobile-menu-button"))!=null&&n.contains(t.target)||H()});var h;(h=document.querySelector("#user-menu-button"))==null||h.addEventListener("click",R);var v;(v=document.querySelector("#mobile-menu-button"))==null||v.addEventListener("click",B);y(r);
