<script>
    const myApiEndpoint = "https://gjclmptpvaepykpghadl.functions.supabase.co/trusty/test";
    const urlParams = new URLSearchParams(window.location.search);
    const code = urlParams.get("code");
    // var xhr = new XMLHttpRequest();
    // xhr.open("POST", myApiEndpoint, true);
    // xhr.setRequestHeader('Content-Type', 'application/json');
    // // xhr.setRequestHeader('Content-Type', 'application/json');
    // xhr.send(JSON.stringify({
    //     code: code
    // }));
    let data = { code: code };

    // fetch(myApiEndpoint, {
    //     method: "POST",
    //     headers: {
    //         'Content-Type': 'application/json',
    //         'Authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdqY2xtcHRwdmFlcHlrcGdoYWRsIiwicm9sZSI6ImFub24iLCJpYXQiOjE2NTY3OTQ4OTksImV4cCI6MTk3MjM3MDg5OX0.n-WN4gsTP7HgmXjnupOtu-j0fj2hIiACEhy3NagJZt4'
    //     },
    //     body: JSON.stringify(data)
    // }).then(res => {
    //     console.log("Request complete! response:", res);
    //     res.text().then(response => {
    //         console.log(response);
    //     })
    // });

    fetch("https://gjclmptpvaepykpghadl.functions.supabase.co/trusty/test", {
        method: "POST",
        headers: { 'Content-Type': 'application/json' },
        headers: { 'Authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdqY2xtcHRwdmFlcHlrcGdoYWRsIiwicm9sZSI6ImFub24iLCJpYXQiOjE2NTY3OTQ4OTksImV4cCI6MTk3MjM3MDg5OX0.n-WN4gsTP7HgmXjnupOtu-j0fj2hIiACEhy3NagJZt4' },
        body: '{"code":"'+code+'"}'
    }).then(res => {
        console.log("Request complete! response:", res);
        res.text().then(response=>{
            console.log(response);
        })
    });
</script>